unsigned char i;
 unsigned char j;
/*Port Definitions*/
int Max7219_pinCLK = 3;
int Max7219_pinDIN = 2;


int matrix1_CS= A0;
int matrix2_CS= 15;
int matrix3_CS= 14;
int matrix4_CS= 16;
int matrix5_CS= 10;

int numMatrixes=5;

int csPins[5]={matrix1_CS,matrix2_CS,matrix3_CS,matrix4_CS,matrix5_CS};


unsigned char disp1[40][8]={
{0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x3C},//0
{0x10,0x18,0x14,0x10,0x10,0x10,0x10,0x10},//1
{0x7E,0x2,0x2,0x7E,0x40,0x40,0x40,0x7E},//2
{0x3E,0x2,0x2,0x3E,0x2,0x2,0x3E,0x0},//3
{0x8,0x18,0x28,0x48,0xFE,0x8,0x8,0x8},//4
{0x3C,0x20,0x20,0x3C,0x4,0x4,0x3C,0x0},//5
{0x3C,0x20,0x20,0x3C,0x24,0x24,0x3C,0x0},//6
{0x3E,0x22,0x4,0x8,0x8,0x8,0x8,0x8},//7
{0x0,0x3E,0x22,0x22,0x3E,0x22,0x22,0x3E},//8
{0x3E,0x22,0x22,0x3E,0x2,0x2,0x2,0x3E},//9
{0x8,0x14,0x22,0x3E,0x22,0x22,0x22,0x22},//A
{0x3C,0x22,0x22,0x3E,0x22,0x22,0x3C,0x0},//B
{0x3C,0x40,0x40,0x40,0x40,0x40,0x3C,0x0},//C
{0x7C,0x42,0x42,0x42,0x42,0x42,0x7C,0x0},//D
{0x7C,0x40,0x40,0x7C,0x40,0x40,0x40,0x7C},//E
{0x7C,0x40,0x40,0x7C,0x40,0x40,0x40,0x40},//F
{0x3C,0x40,0x40,0x40,0x40,0x44,0x44,0x3C},//G
{0x44,0x44,0x44,0x7C,0x44,0x44,0x44,0x44},//H
{0x7C,0x10,0x10,0x10,0x10,0x10,0x10,0x7C},//I
{0x3C,0x8,0x8,0x8,0x8,0x8,0x48,0x30},//J
{0x0,0x24,0x28,0x30,0x20,0x30,0x28,0x24},//K
{0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x7C},//L
{0x81,0xC3,0xA5,0x99,0x81,0x81,0x81,0x81},//M
{0x0,0x42,0x62,0x52,0x4A,0x46,0x42,0x0},//N
{0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x3C},//O
{0x3C,0x22,0x22,0x22,0x3C,0x20,0x20,0x20},//P
{0x1C,0x22,0x22,0x22,0x22,0x26,0x22,0x1D},//Q
{0x3C,0x22,0x22,0x22,0x3C,0x24,0x22,0x21},//R
{0x0,0x1E,0x20,0x20,0x3E,0x2,0x2,0x3C},//S
{0x0,0x3E,0x8,0x8,0x8,0x8,0x8,0x8},//T
{0x42,0x42,0x42,0x42,0x42,0x42,0x22,0x1C},//U
{0x42,0x42,0x42,0x42,0x42,0x42,0x24,0x18},//V
{0x0,0x49,0x49,0x49,0x49,0x2A,0x1C,0x0},//W
{0x0,0x41,0x22,0x14,0x8,0x14,0x22,0x41},//X
{0x41,0x22,0x14,0x8,0x8,0x8,0x8,0x8},//Y
{0x0,0x7F,0x2,0x4,0x8,0x10,0x20,0x7F},//Z
{0x8,0x14,0x8,0x1C,0x22,0x3E,0x22,0x22}, //Å
{0x18,0x18,0x18,0x18,0x18,0x00,0x18,0x18}, //!
{0x38,0x6c,0x6c,0x0c,0x18,0x18,0x00,0x18},//?
{0x00,0x66,0x66,0x00,0x3c,0x24,0x18,0x00}, //surprised face
};



void Write_Max7219_byte(unsigned char DATA)
{
            unsigned char i;
	    //digitalWrite(csPin,LOW);
	    for(i=8;i>=1;i--)
          {
             digitalWrite(Max7219_pinCLK,LOW);
             digitalWrite(Max7219_pinDIN,DATA&0x80);// Extracting a bit data
             DATA = DATA<<1;
             digitalWrite(Max7219_pinCLK,HIGH);
           }
          // digitalWrite(csPin,HIGH);
}


void Write_Max7219(unsigned char address,unsigned char dat, int csPin)
{
        digitalWrite(csPin,LOW);
        Write_Max7219_byte(address);           //address，code of LED
        Write_Max7219_byte(dat);               //data，figure on LED
        digitalWrite(csPin,HIGH);
}

void Init_MAX7219(int csPin)
{
 Write_Max7219(0x09, 0x00, csPin);       //decoding ：BCD
 Write_Max7219(0x0a, 0x03, csPin);       //brightness
 Write_Max7219(0x0b, 0x07, csPin);       //scanlimit；8 LEDs
 Write_Max7219(0x0c, 0x01, csPin);       //power-down mode：0，normal mode：1
 Write_Max7219(0x0f, 0x00, csPin);       //test display：1；EOT，display：0
}



void setup()
{

  pinMode(Max7219_pinCLK,OUTPUT);
  pinMode(Max7219_pinDIN,OUTPUT);

  for(int i=0; i<numMatrixes; i++)
  	{
  		pinMode(csPins[i],OUTPUT);
		delay(50);
  		Init_MAX7219(csPins[i]);
  	}
}


void loop()
{

clear(50);

for(i=1;i<9;i++) Write_Max7219(i,disp1[39][i-1],matrix1_CS); //face

//OMG
for(i=1;i<9;i++) Write_Max7219(i,disp1[24][i-1],matrix2_CS); //O
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[22][i-1],matrix3_CS); //M
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[16][i-1],matrix4_CS); //G
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[37][i-1],matrix5_CS); //!
delay(250);

clear(50);

for(i=1;i<9;i++) Write_Max7219(i,disp1[39][i-1],matrix1_CS); //face

//WTF
for(i=1;i<9;i++) Write_Max7219(i,disp1[32][i-1],matrix2_CS); //W
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[29][i-1],matrix3_CS); //T
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[15][i-1],matrix4_CS); //F
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[38][i-1],matrix5_CS); //?
delay(250);


clear(50);

//DDLAB
ddlab(50);

delay(250);

clear(50);

for(i=1;i<9;i++) Write_Max7219(i,disp1[39][i-1],matrix1_CS); //face

//FTW!

for(i=1;i<9;i++) Write_Max7219(i,disp1[15][i-1],matrix2_CS); //F
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[29][i-1],matrix3_CS); //T
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[32][i-1],matrix4_CS); //W
delay(50);
for(i=1;i<9;i++) Write_Max7219(i,disp1[37][i-1],matrix5_CS); //!

delay(250);


}

void ddlab(int del)
{
	unsigned char ddlab_[5][8]={
	{0x7C,0x42,0x42,0x42,0x42,0x42,0x7C,0x0},//D
	{0x7C,0x42,0x42,0x42,0x42,0x42,0x7C,0x0},//D
	{0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x7C},//L
	{0x8,0x14,0x22,0x3E,0x22,0x22,0x22,0x22},//A
	{0x3C,0x22,0x22,0x3E,0x22,0x22,0x3C,0x0}//B
};


   for(j=0;j<5;j++)
  {
   for(i=1;i<9;i++)
    Write_Max7219(i,ddlab_[j][i-1],csPins[j]);
   delay(del);
  }
}


void clear(int del)
 {     for(j=0;j<5;j++)
  {
   for(i=1;i<9;i++)
    Write_Max7219(i,0x0,csPins[j]);
   delay(del);
  }
}

/*
void god(int del)
{
	unsigned char god_[3][8]={
	{0x3C,0x40,0x40,0x40,0x40,0x44,0x44,0x3C},//G
	{0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x3C},//O
	{0x7C,0x42,0x42,0x42,0x42,0x42,0x7C,0x0}//D
	};

	   for(j=0;j<3;j++) //for each char
  {
   for(i=1;i<9;i++)
    Write_Max7219(i,god_[j][i-1],csPins[j+1]);
   delay(del);
  }
}

void godt(int del)
{
	unsigned char godt_[4][8]={
	{0x3C,0x40,0x40,0x40,0x40,0x44,0x44,0x3C},//G
	{0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x3C},//O
	{0x7C,0x42,0x42,0x42,0x42,0x42,0x7C,0x0},//D
	{0x0,0x3E,0x8,0x8,0x8,0x8,0x8,0x8}//T
	};

	   for(j=0;j<4;j++) //for each char
  {
   for(i=1;i<9;i++)
    Write_Max7219(i,godt_[j][i-1],csPins[j+1]);
   delay(del);
  }
}


void jul(int del)
{
	unsigned char jul_[3][8]={
	{0x3C,0x8,0x8,0x8,0x8,0x8,0x48,0x30},//J
	{0x42,0x42,0x42,0x42,0x42,0x42,0x22,0x1C},//U
	{0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x7C}//L
};

	   for(j=0;j<3;j++)
  {
   for(i=1;i<9;i++)
    Write_Max7219(i,jul_[j][i-1],csPins[j+1]);
   delay(del);
  }
}

void nytaar(int del)
{
unsigned char nytaar_[5][8]={
{0x0,0x42,0x62,0x52,0x4A,0x46,0x42,0x0},//N
{0x41,0x22,0x14,0x8,0x8,0x8,0x8,0x8},//Y
{0x0,0x3E,0x8,0x8,0x8,0x8,0x8,0x8},//T
{0x8,0x14,0x8,0x1C,0x22,0x3E,0x22,0x22}, //Å
{0x3C,0x22,0x22,0x22,0x3C,0x24,0x22,0x21}//R
};

	   for(j=0;j<5;j++)
  {
   for(i=1;i<9;i++)
    Write_Max7219(i,nytaar_[j][i-1],csPins[j]);
   delay(del);
  }

}

void fra(int del)
{

unsigned char fra_[3][8]={
	{0x7C,0x40,0x40,0x7C,0x40,0x40,0x40,0x40},//F
	{0x3C,0x22,0x22,0x22,0x3C,0x24,0x22,0x21},//R
	{0x8,0x14,0x22,0x3E,0x22,0x22,0x22,0x22}//A
};
	   for(j=0;j<3;j++)
  {
   for(i=1;i<9;i++)
    Write_Max7219(i,fra_[j][i-1],csPins[j+1u]);
   delay(del);
  }
}
*/
